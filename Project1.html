<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Project 1 – Oxygen Budget</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
</head>
<body>
  <div class="sidebar">
    <img src="Logo_NS-blackboard-Expand.png" alt="Sidebar Image">
    <nav>
      <ul class="nav-menu">
        <li><a href="Welcome.html">Welcome to NFYK22003U</a></li>
        <li><a href="CourseInformation.html">Course Information</a></li>
        <li>
          <a href="#">Chapter 1</a>
          <ul class="sub-menu">
            <li><a href="Project1.html">Project 1 – Oxygen Budget</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>

  <div class="main-content">
    <h1>Project 1 – Oxygen Budget</h1>

    <p>We saw in class that the highest concentrations of dissolved inorganic carbon (DIC) are in the mid-depth Pacific ocean.</p>

    <ul>
      <li>In Absalon, under files, download <code>theocean.nc</code> and plot the global distribution of DIC at 2000m depth, in an east-west cut, and a north-south cut across the Pacific. The file contains output of a commonly used climate model (Nielsen et al. 2019, Paleoceanography). It helps to use <code>xarray</code>, and a primer for how to use it to analyze model simulations is provided at:  
        <a href="https://veros.readthedocs.io/en/latest/tutorial/analysis.html" target="_blank">https://veros.readthedocs.io/en/latest/tutorial/analysis.html</a>
      </li>
      <li>Use the Reynolds averaged tracer equation to determine the main sources and sinks of DIC in the mid-depth North Pacific (the values for horizontal and vertical turbulent diffusivity are 800 and 1-e5 m²/s, respectively). Pay attention to the units!</li>
      <li>Describe in your own words and based on your analysis above what explains the DIC maximum in the North Pacific.</li>
      <li>Form groups of 2 or 3 and hand in the answers as PDF by Sunday, midnight (i.e. email to <a href="mailto:mjochum@nbi.dk">mjochum@nbi.dk</a>).</li>
    </ul>

    <p>Check the current directory:</p>
    <div class="code-block">
      <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
      <pre><code class="language-python">!pwd
      </code></pre>
    </div>

    <p>List files in the current directory:</p>
    <div class="code-block">
      <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
      <pre><code class="language-python">!ls
      </code></pre>
    </div>

    <p>For example, if you want to check inside the erda_mount directory:</p>

    <div class="code-block">
      <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
      <pre><code class="language-python">!ls erda_mount/
      </code></pre>
    </div>

    <p>To inspect the NetCDF file <code>theocean.nc</code> located in the same folder as your notebook (<code>/home/jovyan/erda_mount</code>), you can do the following directly within a notebook cell:</p>
    <div class="code-block">
        <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
        <pre><code class="language-python">!ls /home/jovyan/erda_mount/theocean.nc # Verify the file exists first
        </code></pre>
      </div>

    <p>Quickly inspect the contents using Python and the <code>xarray</code> package</p>
    <div class="code-block">
        <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
        <pre><code class="language-python">!pip install xarray
        </code></pre>
      </div>
    <div class="code-block">
        <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
        <pre><code class="language-python">import xarray as xr

# Open and inspect the NetCDF file
ds = xr.open_dataset('/home/jovyan/erda_mount/theocean.nc')

# Show dataset details
print(ds)

# Display variables specifically
print("\nData Variables:")
print(ds.data_vars)  
        </code></pre>
      </div>

      <p>To check whether a specific variable (e.g., <code>DIC</code>) exists in an opened xarray dataset and retrieve detailed information about it, you can do the following:</p>
      <div class="code-block">
        <button class="copy-btn" onclick="copyToClipboard(this)">Copy</button>
        <pre><code class="language-python">import xarray as xr

# Load the dataset
ds = xr.open_dataset('/home/jovyan/erda_mount/theocean.nc')

# Check if 'DIC' exists in the dataset
if 'DIC' in ds.variables:
    print("'DIC' variable found!\n")
    
    # Print detailed info about the 'DIC' variable
    print(ds['DIC'])
else:
    print("'DIC' variable not found in the dataset.") 
        </code></pre>
      </div>
      <pre style="font-family: 'Courier New', Courier, monospace; color: #aaccee; background: transparent; border: none; padding: 1em 0; margin: 0;">
'DIC' variable found!

<xarray.DataArray 'DIC' (time: 1, z_t: 60, nlat: 116, nlon: 100)> Size: 3MB
[696000 values with dtype=float32]
Coordinates:
  * time     (time) object 8B 1950-07-16 21:59:59.999997
  * z_t      (z_t) float32 240B 500.0 1.5e+03 2.5e+03 ... 5.125e+05 5.375e+05
    ULONG    (nlat, nlon) float64 93kB ...
    ULAT     (nlat, nlon) float64 93kB ...
    TLONG    (nlat, nlon) float64 93kB ...
    TLAT     (nlat, nlon) float64 93kB ...
Dimensions without coordinates: nlat, nlon
Attributes:
    long_name:     Dissolved Inorganic Carbon
    units:         mmol/m^3
    grid_loc:      3111
    cell_methods:  time: mean
</pre>

<p>But if you plot it directly, the projection might seem not correct</p>
















    <p><strong>Next</strong>: <a href="#">To be continued</a></p>
  </div>

  <div class="footer">
    Qi-fan based on the course material by Markus Jochum & Marta Mrozowska <br>
    It is very much a work in progress! Have you spotted a mistake or an error on this page? 
    Click <a href="mailto:qifan.wu@nbi.ku.dk">here</a> to tell me!<br>
    &copy; 2025 TeamOcean | NBI/KU
  </div>

  <script>
    function copyToClipboard(btn) {
      const code = btn.nextElementSibling.innerText;
      navigator.clipboard.writeText(code).then(() => {
        btn.classList.add('copied');
        setTimeout(() => btn.classList.remove('copied'), 2000);
      });
    }
  </script>
</body>
</html>
